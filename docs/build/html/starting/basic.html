<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Overview &mdash; Velocity  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../_static/icon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Creating Your First Image" href="tutorial.html" />
    <link rel="prev" title="Getting Started" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #909d9e" >

          
          
          <a href="../index.html" class="icon icon-home">
            Velocity
              <img src="../_static/icon.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-it-works">How it Works</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-usage">Basic Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#avail"><cite>avail</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spec"><cite>spec</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="#build"><cite>build</cite></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">Creating Your First Image</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Technical Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #909d9e" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Velocity</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Getting Started</a></li>
      <li class="breadcrumb-item active">Overview</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/starting/basic.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h1>
<section id="how-it-works">
<h2>How it Works<a class="headerlink" href="#how-it-works" title="Link to this heading"></a></h2>
<p>Velocity works by building a set of containers in a chain so that the final container has all of the needed components.
Velocity maintains a very hands off approach. It is only as good as the templates/configuration that you write.
In general it will assume that a particular build will work unless you tell it otherwise. It is important to note
that while Velocity has many features that are similar to those provided by a package manager, it is NOT a
package manager. Rather it should be viewed as a templating and build orchestration tool.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>The easiest way to install velocity is to install prebuilt python packages using pip.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>olcf-velocity
</pre></div>
</div>
<p>You can also clone the velocity repository and build/install velocity from source.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/olcf/velocity.git
<span class="nb">cd</span><span class="w"> </span>velocity
python3<span class="w"> </span>-m<span class="w"> </span>build
<span class="c1"># install the built python wheel package</span>
pip<span class="w"> </span>install<span class="w"> </span>dist/olcf-velocity-&lt;version&gt;*.whl
</pre></div>
</div>
<p>Now you can use Velocity as a python module! We recommend setting a bash alias for convenience.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>user@hostname:~$<span class="w"> </span><span class="nb">alias</span><span class="w"> </span><span class="nv">velocity</span><span class="o">=</span><span class="s2">&quot;python3 -m velocity&quot;</span>
user@hostname:~$<span class="w"> </span>velocity
usage:<span class="w"> </span>velocity<span class="w"> </span><span class="o">[</span>-h<span class="o">]</span><span class="w"> </span><span class="o">[</span>-v<span class="o">]</span><span class="w"> </span><span class="o">[</span>-D<span class="w"> </span><span class="o">{</span>TRACE,DEBUG,INFO,SUCCESS,WARNING,ERROR,CRITICAL<span class="o">}]</span><span class="w"> </span><span class="o">[</span>-b<span class="w"> </span>BACKEND<span class="o">]</span><span class="w"> </span><span class="o">[</span>-s<span class="w"> </span>SYSTEM<span class="o">]</span><span class="w"> </span><span class="o">[</span>-d<span class="w"> </span>DISTRO<span class="o">]</span><span class="w"> </span><span class="o">{</span>build,avail,spec<span class="o">}</span><span class="w"> </span>...

build<span class="w"> </span>tool<span class="w"> </span><span class="k">for</span><span class="w"> </span>OLCF<span class="w"> </span>containers

positional<span class="w"> </span>arguments:
<span class="w">  </span><span class="o">{</span>build,avail,spec<span class="o">}</span>
<span class="w">    </span>build<span class="w">               </span>build<span class="w"> </span>specified<span class="w"> </span>container<span class="w"> </span>image
<span class="w">    </span>avail<span class="w">               </span>lookup<span class="w"> </span>available<span class="w"> </span>images
<span class="w">    </span>spec<span class="w">                </span>lookup<span class="w"> </span>image<span class="w"> </span>dependencies

options:
<span class="w">  </span>-h,<span class="w"> </span>--help<span class="w">            </span>show<span class="w"> </span>this<span class="w"> </span><span class="nb">help</span><span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span><span class="nb">exit</span>
<span class="w">  </span>-v,<span class="w"> </span>--version<span class="w">         </span>program<span class="w"> </span>version
<span class="w">  </span>-D<span class="w"> </span><span class="o">{</span>TRACE,DEBUG,INFO,SUCCESS,WARNING,ERROR,CRITICAL<span class="o">}</span>,<span class="w"> </span>--debug<span class="w"> </span><span class="o">{</span>TRACE,DEBUG,INFO,SUCCESS,WARNING,ERROR,CRITICAL<span class="o">}</span>
<span class="w">                        </span><span class="nb">set</span><span class="w"> </span>debug<span class="w"> </span>output<span class="w"> </span>level
<span class="w">  </span>-b<span class="w"> </span>BACKEND,<span class="w"> </span>--backend<span class="w"> </span>BACKEND
<span class="w">  </span>-s<span class="w"> </span>SYSTEM,<span class="w"> </span>--system<span class="w"> </span>SYSTEM
<span class="w">  </span>-d<span class="w"> </span>DISTRO,<span class="w"> </span>--distro<span class="w"> </span>DISTRO

See<span class="w"> </span>https://github.com/olcf/velocity
</pre></div>
</div>
</section>
<section id="configuration">
<span id="id1"></span><h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading"></a></h2>
<p>Velocity has a number of configuration options. The basic ones are setting the system name, container backend,
container distro, the path(s) to your image definitions and the build scratch directory.
To see more configuration options go to the <a class="reference internal" href="../reference/config.html"><span class="doc">configuration</span></a> page. The easiest way to configure velocity is to
edit <code class="docutils literal notranslate"><span class="pre">~/.velocity/config.yaml</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">velocity</span><span class="p">:</span>
  <span class="n">system</span><span class="p">:</span> <span class="n">frontier</span>
  <span class="n">backend</span><span class="p">:</span> <span class="n">apptainer</span>
  <span class="n">distro</span><span class="p">:</span> <span class="n">ubuntu</span>
  <span class="n">image_path</span><span class="p">:</span> <span class="c1"># a list of : seperated paths</span>
  <span class="n">build_dir</span><span class="p">:</span> <span class="c1"># path to a scratch space</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Image definitions can be created by the user as needed but a base set for usage at OLCF are provided at
<a class="reference external" href="https://github.com/olcf/velocity-images">https://github.com/olcf/velocity-images</a></p>
</div>
</section>
<section id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Link to this heading"></a></h2>
<section id="avail">
<h3><cite>avail</cite><a class="headerlink" href="#avail" title="Link to this heading"></a></h3>
<p>The <cite>avail</cite> command prints the defined images that can be built.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>user@hostname:~$<span class="w"> </span>velocity<span class="w"> </span><span class="nv">avail</span>
<span class="o">==</span>&gt;<span class="w"> </span>gcc
<span class="w">    </span><span class="m">12</span>.3.0
<span class="w">    </span><span class="m">13</span>.2.0
<span class="w">    </span><span class="m">14</span>.1.0
<span class="o">==</span>&gt;<span class="w"> </span>mpich
<span class="w">    </span><span class="m">3</span>.4.3
<span class="o">==</span>&gt;<span class="w"> </span>rocm
<span class="w">    </span><span class="m">5</span>.7.1
<span class="o">==</span>&gt;<span class="w"> </span>ubuntu
<span class="w">    </span><span class="m">20</span>.04
<span class="w">    </span><span class="m">22</span>.04
<span class="w">    </span><span class="m">24</span>.04
</pre></div>
</div>
<p>Each image is listed and then indented underneath is a list of the available versions.</p>
</section>
<section id="spec">
<h3><cite>spec</cite><a class="headerlink" href="#spec" title="Link to this heading"></a></h3>
<p>The <cite>spec</cite> command shows the dependencies for a given image (or list of images) in a tree like structure.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>user@hostname:~$<span class="w"> </span>velocity<span class="w"> </span>spec<span class="w"> </span>pytorch
<span class="w">  </span>&gt;<span class="w"> </span>pytorch@latest
<span class="w">     </span>^cuda@11.7.1
<span class="w">        </span>^centos@stream8
<span class="w">     </span>^cudnn@8.5.0.96
<span class="w">        </span>^cuda@11.7.1
<span class="w">           </span>^centos@stream8
<span class="w">     </span>^spectrum-mpi@10.4.0.6
<span class="w">        </span>^centos@stream8
<span class="w">     </span>^gcc@11.2.0
<span class="w">        </span>^centos@stream8
<span class="w">     </span>^miniforge3@23.11.0
<span class="w">        </span>^centos@stream8
</pre></div>
</div>
</section>
<section id="build">
<h3><cite>build</cite><a class="headerlink" href="#build" title="Link to this heading"></a></h3>
<p>The <cite>build</cite> command can be used to build an container image from one or more image definitions.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>user@hostname:~$<span class="w"> </span>velocity<span class="w"> </span>build<span class="w"> </span><span class="nv">centos</span>
<span class="o">==</span>&gt;<span class="w"> </span>Build<span class="w"> </span>Order:
<span class="w">        </span>centos@<span class="o">=</span><span class="nv">stream8</span>

<span class="o">==</span>&gt;<span class="w"> </span>iarfnxer:<span class="w"> </span>BUILD<span class="w"> </span>centos@<span class="o">=</span>stream8<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>iarfnxer:<span class="w"> </span>GENERATING<span class="w"> </span>SCRIPT<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>iarfnxer:<span class="w"> </span>BUILDING<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>iarfnxer:<span class="w"> </span>IMAGE<span class="w"> </span>localhost/centos__stream8__x86_64__centos:latest<span class="w"> </span><span class="o">(</span>centos@<span class="o">=</span>stream8<span class="o">)</span><span class="w"> </span>BUILT<span class="w"> </span><span class="o">(</span><span class="m">0</span>:01:22<span class="o">)</span>
</pre></div>
</div>
<p>Both the spec and the build command can also take a list of images.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>user@hostname:~$<span class="w"> </span>velocity<span class="w"> </span>build<span class="w"> </span>gcc<span class="w"> </span><span class="nv">python</span>
<span class="o">==</span>&gt;<span class="w"> </span>Build<span class="w"> </span>Order:
<span class="w">        </span>centos@<span class="o">=</span>stream8
<span class="w">        </span>gcc@<span class="o">=</span><span class="m">11</span>.2.0
<span class="w">        </span>python@<span class="o">=</span><span class="m">3</span>.11.8

<span class="o">==</span>&gt;<span class="w"> </span>pbxpudvh:<span class="w"> </span>BUILD<span class="w"> </span>centos@<span class="o">=</span>stream8<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>pbxpudvh:<span class="w"> </span>GENERATING<span class="w"> </span>SCRIPT<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>pbxpudvh:<span class="w"> </span>BUILDING<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>pbxpudvh:<span class="w"> </span>IMAGE<span class="w"> </span>localhost/pbxpudvh:latest<span class="w"> </span><span class="o">(</span>centos@<span class="o">=</span>stream8<span class="o">)</span><span class="w"> </span>BUILT<span class="w"> </span><span class="o">[</span><span class="m">0</span>:01:00<span class="o">]</span>

<span class="o">==</span>&gt;<span class="w"> </span>lxogjapp:<span class="w"> </span>BUILD<span class="w"> </span>gcc@<span class="o">=</span><span class="m">11</span>.2.0<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>lxogjapp:<span class="w"> </span>GENERATING<span class="w"> </span>SCRIPT<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>lxogjapp:<span class="w"> </span>BUILDING<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>lxogjapp:<span class="w"> </span>IMAGE<span class="w"> </span>localhost/lxogjapp:latest<span class="w"> </span><span class="o">(</span>gcc@<span class="o">=</span><span class="m">11</span>.2.0<span class="o">)</span><span class="w"> </span>BUILT<span class="w"> </span><span class="o">[</span><span class="m">0</span>:40:34<span class="o">]</span>

<span class="o">==</span>&gt;<span class="w"> </span>sunflyhd:<span class="w"> </span>BUILD<span class="w"> </span>python@<span class="o">=</span><span class="m">3</span>.11.8<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>sunflyhd:<span class="w"> </span>GENERATING<span class="w"> </span>SCRIPT<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>sunflyhd:<span class="w"> </span>BUILDING<span class="w"> </span>...
<span class="o">==</span>&gt;<span class="w"> </span>sunflyhd:<span class="w"> </span>IMAGE<span class="w"> </span>localhost/python__3.11.8__x86_64__centos:latest<span class="w"> </span><span class="o">(</span>python@<span class="o">=</span><span class="m">3</span>.11.8<span class="o">)</span><span class="w"> </span>BUILT<span class="w"> </span><span class="o">[</span><span class="m">0</span>:23:19<span class="o">]</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial.html" class="btn btn-neutral float-right" title="Creating Your First Image" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, OLCF.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>